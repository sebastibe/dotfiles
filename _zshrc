# Disclaimer: this zsh config use my own fork of oh-my-zsh
# locales
export LC_ALL=en_US.UTF-8
export LANG=en_US.UTF-8

export EMACS=/usr/local/Cellar/emacs-mac/emacs-24.3-mac-4.2/bin/emacs
alias em="emacsclient -n"
export EDITOR="emacsclient -n"
export SHELL="/bin/zsh"

# Path to development folder
export DEV=$HOME/Dev
export DEPLOY_USER="seb"

# Path to your oh-my-zsh configuration.
export ZSH=$DEV/oh-my-zsh

export PATH="/usr/local/bin:/usr/local/sbin:/usr/local/mysql/bin:/usr/local/share/npm/bin:$HOME/Library/Python/2.7/bin:$HOME/.rvm/bin:$PATH:$HOME/go/bin:/Applications/Postgres.app/Contents/Versions/9.3/bin"

#export ZSH_THEME="powerline"  # prose, agnoster are also good

export DISABLE_CORRECTION="true"
# Set to this to use case-sensitive completion
# export CASE_SENSITIVE="true"

# Comment this out to disable weekly auto-update checks
# export DISABLE_AUTO_UPDATE="true"

# Uncomment following line if you want to disable colors in ls
# export DISABLE_LS_COLORS="true"

# Uncomment following line if you want to disable autosetting terminal title.
export DISABLE_AUTO_TITLE="true"

# Configuration for postgres
export PGHOST=/tmp

# Virtualenv wrapper
export VIRTUALENVWRAPPER_LOG_DIR="logs"
export WORKON_HOME=$DEV
source /usr/local/bin/virtualenvwrapper.sh
export PIP_VIRTUALENV_BASE=$WORKON_HOME

alias bpython="python -m bpython.cli"

# check https://github.com/zsh-users/zsh-syntax-highlighting
plugins=(git git-flow brew fabric django pip osx vagrant python gem supervisor\
 screen node npm virtualenv virtualenvwrapper bower clipboard zsh-syntax-highlighting\
 rvm autojump tmuxinator postgres redis-cli celery grunt yeoman ansible)

source $ZSH/oh-my-zsh.sh

# Powerline setup
export DEFAULT_USER="seb"
export POWERLINE_HIDE_HOST_NAME="true"
export POWERLINE_DETECT_SSH="true"
export TERM="xterm-256color"

# Env name is already displayed in powerline
export VIRTUAL_ENV_DISABLE_PROMPT="true"

# Require powerline: pip install --user git+git://github.com/Lokaltog/powerline
source ~/Library/Python/2.7/lib/python/site-packages/powerline/bindings/zsh/powerline.zsh

# Ruby
export rvm_path=$HOME/.rvm
source $rvm_path/scripts/rvm

[[ -s $HOME/.tmuxinator/scripts/tmuxinator ]] && source $HOME/.tmuxinator/scripts/tmuxinator

# Python
eval "$(pyenv init -)"

# Go
export GOPATH=`pwd`

# iTerm2 window/tab color commands
#   Requires iTerm2 >= Build 1.0.0.20110804
#   http://code.google.com/p/iterm2/wiki/ProprietaryEscapeCodes
tab-color() {
    echo -ne "\033]6;1;bg;red;brightness;$1\a"
    echo -ne "\033]6;1;bg;green;brightness;$2\a"
    echo -ne "\033]6;1;bg;blue;brightness;$3\a"
}
tab-reset() {
    echo -ne "\033]6;1;bg;*;default\a"
}

# Change the color of the tab when using SSH
# reset the color after the connection closes
color-ssh() {
    if [[ -n "$ITERM_SESSION_ID" ]]; then
        trap "tab-reset" INT EXIT
        if [[ "$*" =~ "production|ec2-.*compute-1" ]]; then
            tab-color 255 0 0
        else
            tab-color 0 255 0
        fi
    fi
    ssh $*
}
compdef _ssh color-ssh=ssh

alias ssh=color-ssh

_archey() {
    if hash archey 2>/dev/null; then
        archey
    else
        echo -ne "You should install Archey"
    fi
}

_archey
